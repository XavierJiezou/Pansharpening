wandb_version: 1

_wandb:
  desc: null
  value:
    python_version: 3.9.18
    cli_version: 0.15.12
    framework: torch
    is_jupyter_run: false
    is_kaggle_kernel: false
    start_time: 1700059364.950113
    t:
      1:
      - 1
      - 41
      - 50
      - 55
      2:
      - 1
      - 41
      - 50
      - 55
      3:
      - 2
      - 7
      - 13
      - 15
      - 23
      4: 3.9.18
      5: 0.15.12
      8:
      - 5
      13: linux-x86_64
    m:
    - 1: trainer/global_step
      6:
      - 3
    - 1: val/loss
      5: 1
      6:
      - 1
    - 1: val/psnr
      5: 1
      6:
      - 1
    - 1: val/ssim
      5: 1
      6:
      - 1
    - 1: val/ssim_best
      5: 1
      6:
      - 1
    - 1: epoch
      5: 1
      6:
      - 1
    - 1: train/loss
      5: 1
      6:
      - 1
    - 1: train/psnr
      5: 1
      6:
      - 1
    - 1: train/ssim
      5: 1
      6:
      - 1
    - 1: test/loss
      5: 1
      6:
      - 1
    - 1: test/psnr
      5: 1
      6:
      - 1
    - 1: test/ssim
      5: 1
      6:
      - 1
model:
  desc: null
  value:
    _target_: src.models.panbench_module.PanBenchLitModule
    optimizer:
      _target_: torch.optim.Adam
      _partial_: true
      lr: 0.001
      weight_decay: 0.0
    scheduler:
      _target_: torch.optim.lr_scheduler.ReduceLROnPlateau
      _partial_: true
      mode: min
      factor: 0.1
      patience: 10
    net:
      _target_: src.models.components.uedm.UEDM
      width: 32
    compile: false
model/params/total:
  desc: null
  value: 648388
model/params/trainable:
  desc: null
  value: 648388
model/params/non_trainable:
  desc: null
  value: 0
data:
  desc: null
  value:
    _target_: src.data.panbench_datamodule.PanBenchDataModule
    data_dir: ${paths.data_dir}
    batch_size: 16
    train_val_test_split:
    - 4718
    - 590
    - 590
    num_workers: 8
    pin_memory: true
    persistent_workers: true
trainer:
  desc: null
  value:
    _target_: lightning.pytorch.trainer.Trainer
    default_root_dir: ${paths.output_dir}
    min_epochs: 50
    max_epochs: 100
    accelerator: gpu
    devices:
    - 2
    check_val_every_n_epoch: 1
    deterministic: false
    gradient_clip_val: 0.5
callbacks:
  desc: null
  value:
    model_checkpoint:
      _target_: lightning.pytorch.callbacks.ModelCheckpoint
      dirpath: ${paths.output_dir}/checkpoints
      filename: epoch={epoch}-val_psnr={val/psnr:.4f}-val_ssim={val/ssim:.4f}
      monitor: val/ssim
      verbose: false
      save_last: false
      save_top_k: 1
      mode: max
      auto_insert_metric_name: false
      save_weights_only: false
      every_n_train_steps: null
      train_time_interval: null
      every_n_epochs: null
      save_on_train_epoch_end: null
    early_stopping:
      _target_: lightning.pytorch.callbacks.EarlyStopping
      monitor: val/ssim
      min_delta: 0.0
      patience: 10
      verbose: false
      mode: max
      strict: true
      check_finite: true
      stopping_threshold: null
      divergence_threshold: null
      check_on_train_epoch_end: null
    model_summary:
      _target_: lightning.pytorch.callbacks.RichModelSummary
      max_depth: -1
    rich_progress_bar:
      _target_: lightning.pytorch.callbacks.RichProgressBar
extras:
  desc: null
  value:
    ignore_warnings: false
    enforce_tags: true
    print_config: true
task_name:
  desc: null
  value: train
tags:
  desc: null
  value:
  - panbench
  - uedm6
ckpt_path:
  desc: null
  value: null
seed:
  desc: null
  value: 42
